{"ast":null,"code":"export function subscribeToNewBlock(provider, chainId, dispatch, isActive) {\n  if (provider && chainId !== undefined && isActive) {\n    var update = function update(blockNumber) {\n      return dispatch({\n        chainId: chainId,\n        blockNumber: blockNumber\n      });\n    };\n    provider.on('block', update);\n    provider.getBlockNumber().then(function (blockNumber) {\n      return update(blockNumber);\n    }, function (err) {\n      console.error(err);\n    });\n    return function () {\n      provider.off('block', update);\n    };\n  }\n  return function () {\n    return undefined;\n  };\n}","map":{"version":3,"names":["subscribeToNewBlock","provider","chainId","dispatch","isActive","undefined","update","blockNumber","on","getBlockNumber","then","err","console","error","off"],"sources":["D:\\CC\\Server\\prototype\\node_modules\\@usedapp\\core\\src\\providers\\blockNumber\\common\\subscribeToNewBlock.ts"],"sourcesContent":["import { providers } from 'ethers'\nimport { ChainId } from '../../../constants'\nimport { Dispatch } from 'react'\nimport { BlockNumberChanged } from './reducer'\n\nexport function subscribeToNewBlock(\n  provider: providers.BaseProvider | undefined,\n  chainId: ChainId | undefined,\n  dispatch: Dispatch<BlockNumberChanged>,\n  isActive: boolean\n) {\n  if (provider && chainId !== undefined && isActive) {\n    const update = (blockNumber: number) => dispatch({ chainId, blockNumber })\n    provider.on('block', update)\n\n    provider.getBlockNumber().then(\n      (blockNumber) => update(blockNumber),\n      (err) => {\n        console.error(err)\n      }\n    )\n\n    return () => {\n      provider.off('block', update)\n    }\n  }\n\n  return () => undefined\n}\n"],"mappings":"AAKA,OAAM,SAAUA,mBAAmBA,CACjCC,QAA4C,EAC5CC,OAA4B,EAC5BC,QAAsC,EACtCC,QAAiB;EAEjB,IAAIH,QAAQ,IAAIC,OAAO,KAAKG,SAAS,IAAID,QAAQ,EAAE;IACjD,IAAME,MAAM,GAAG,SAATA,MAAMA,CAAIC,WAAmB;MAAA,OAAKJ,QAAQ,CAAC;QAAED,OAAO,EAAPA,OAAO;QAAEK,WAAW,EAAXA;MAAW,CAAE,CAAC;IAAA;IAC1EN,QAAQ,CAACO,EAAE,CAAC,OAAO,EAAEF,MAAM,CAAC;IAE5BL,QAAQ,CAACQ,cAAc,EAAE,CAACC,IAAI,CAC5B,UAACH,WAAW;MAAA,OAAKD,MAAM,CAACC,WAAW,CAAC;IAAA,GACpC,UAACI,GAAG,EAAI;MACNC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;IACpB,CAAC,CACF;IAED,OAAO,YAAK;MACVV,QAAQ,CAACa,GAAG,CAAC,OAAO,EAAER,MAAM,CAAC;IAC/B,CAAC;;EAGH,OAAO;IAAA,OAAMD,SAAS;EAAA;AACxB"},"metadata":{},"sourceType":"module","externalDependencies":[]}