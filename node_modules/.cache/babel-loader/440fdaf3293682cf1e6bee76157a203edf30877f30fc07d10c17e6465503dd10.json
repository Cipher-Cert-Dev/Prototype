{"ast":null,"code":"import { MultiCallABI } from '../constants';\nimport { BigNumber } from 'ethers';\nimport { useMulticallAddress } from './useMulticallAddress';\nimport { useRawCall } from './useRawCalls';\nimport { useChainId } from './useChainId';\nimport { useConfig } from './useConfig';\nimport { useBlockNumbers } from './useBlockNumbers';\nimport { useMemo } from 'react';\nvar GET_CURRENT_BLOCK_TIMESTAMP_CALL = MultiCallABI.encodeFunctionData('getCurrentBlockTimestamp', []);\nvar GET_CURRENT_BLOCK_DIFFICULTY_CALL = MultiCallABI.encodeFunctionData('getCurrentBlockDifficulty', []);\n/**\n * Queries block metadata.\n * @public\n */\nexport function useBlockMeta() {\n  var queryParams = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _a, _b;\n  var chainId = useChainId({\n    queryParams: queryParams\n  });\n  var _useConfig = useConfig(),\n    configRefresh = _useConfig.refresh;\n  var blockNumbers = useBlockNumbers();\n  var address = useMulticallAddress(queryParams);\n  var refresh = (_a = queryParams.refresh) !== null && _a !== void 0 ? _a : configRefresh;\n  var isStatic = (_b = queryParams.isStatic) !== null && _b !== void 0 ? _b : refresh === 'never';\n  var refreshPerBlocks = typeof refresh === 'number' ? refresh : undefined;\n  var timestampResult = useRawCall(address && chainId !== undefined && {\n    address: address,\n    data: GET_CURRENT_BLOCK_TIMESTAMP_CALL,\n    chainId: chainId,\n    isStatic: isStatic,\n    refreshPerBlocks: refreshPerBlocks\n  });\n  var difficulty = useRawCall(address && chainId !== undefined && {\n    address: address,\n    data: GET_CURRENT_BLOCK_DIFFICULTY_CALL,\n    chainId: chainId,\n    isStatic: isStatic,\n    refreshPerBlocks: refreshPerBlocks\n  });\n  var timestamp = useMemo(function () {\n    try {\n      return timestampResult !== undefined ? new Date(BigNumber.from(timestampResult.value).mul(1000).toNumber()) : undefined;\n    } catch (e) {\n      console.warn('Failed to parse timestamp of a block', e);\n    }\n  }, [timestampResult]);\n  return {\n    timestamp: timestamp,\n    difficulty: difficulty !== undefined ? BigNumber.from(difficulty.value) : undefined,\n    blockNumber: chainId ? blockNumbers[chainId] : undefined\n  };\n}","map":{"version":3,"names":["MultiCallABI","BigNumber","useMulticallAddress","useRawCall","useChainId","useConfig","useBlockNumbers","useMemo","GET_CURRENT_BLOCK_TIMESTAMP_CALL","encodeFunctionData","GET_CURRENT_BLOCK_DIFFICULTY_CALL","useBlockMeta","queryParams","arguments","length","undefined","chainId","_useConfig","configRefresh","refresh","blockNumbers","address","_a","isStatic","_b","refreshPerBlocks","timestampResult","data","difficulty","timestamp","Date","from","value","mul","toNumber","e","console","warn","blockNumber"],"sources":["D:\\CC\\Server\\prototype\\node_modules\\@usedapp\\core\\src\\hooks\\useBlockMeta.ts"],"sourcesContent":["import { ChainId, MultiCallABI } from '../constants'\nimport { BigNumber } from 'ethers'\nimport { useMulticallAddress } from './useMulticallAddress'\nimport { QueryParams } from '../constants/type/QueryParams'\nimport { useRawCall } from './useRawCalls'\nimport { useChainId } from './useChainId'\nimport { useConfig } from './useConfig'\nimport { useBlockNumbers } from './useBlockNumbers'\nimport { useMemo } from 'react'\n\nconst GET_CURRENT_BLOCK_TIMESTAMP_CALL = MultiCallABI.encodeFunctionData('getCurrentBlockTimestamp', [])\nconst GET_CURRENT_BLOCK_DIFFICULTY_CALL = MultiCallABI.encodeFunctionData('getCurrentBlockDifficulty', [])\n\n/**\n * Queries block metadata.\n * @public\n */\nexport function useBlockMeta(queryParams: QueryParams = {}) {\n  const chainId = useChainId({ queryParams })\n  const { refresh: configRefresh } = useConfig()\n  const blockNumbers = useBlockNumbers()\n\n  const address = useMulticallAddress(queryParams)\n  const refresh = queryParams.refresh ?? configRefresh\n  const isStatic = queryParams.isStatic ?? refresh === 'never'\n  const refreshPerBlocks = typeof refresh === 'number' ? refresh : undefined\n  const timestampResult = useRawCall(\n    address &&\n      chainId !== undefined && {\n        address,\n        data: GET_CURRENT_BLOCK_TIMESTAMP_CALL,\n        chainId,\n        isStatic,\n        refreshPerBlocks,\n      }\n  )\n  const difficulty = useRawCall(\n    address &&\n      chainId !== undefined && {\n        address,\n        data: GET_CURRENT_BLOCK_DIFFICULTY_CALL,\n        chainId,\n        isStatic,\n        refreshPerBlocks,\n      }\n  )\n\n  const timestamp = useMemo(() => {\n    try {\n      return timestampResult !== undefined\n        ? new Date(BigNumber.from(timestampResult.value).mul(1000).toNumber())\n        : undefined\n    } catch (e: any) {\n      console.warn('Failed to parse timestamp of a block', e)\n    }\n  }, [timestampResult])\n\n  return {\n    timestamp,\n    difficulty: difficulty !== undefined ? BigNumber.from(difficulty.value) : undefined,\n    blockNumber: chainId ? blockNumbers[chainId as ChainId] : undefined,\n  }\n}\n"],"mappings":"AAAA,SAAkBA,YAAY,QAAQ,cAAc;AACpD,SAASC,SAAS,QAAQ,QAAQ;AAClC,SAASC,mBAAmB,QAAQ,uBAAuB;AAE3D,SAASC,UAAU,QAAQ,eAAe;AAC1C,SAASC,UAAU,QAAQ,cAAc;AACzC,SAASC,SAAS,QAAQ,aAAa;AACvC,SAASC,eAAe,QAAQ,mBAAmB;AACnD,SAASC,OAAO,QAAQ,OAAO;AAE/B,IAAMC,gCAAgC,GAAGR,YAAY,CAACS,kBAAkB,CAAC,0BAA0B,EAAE,EAAE,CAAC;AACxG,IAAMC,iCAAiC,GAAGV,YAAY,CAACS,kBAAkB,CAAC,2BAA2B,EAAE,EAAE,CAAC;AAE1G;;;;AAIA,OAAM,SAAUE,YAAYA,CAAA,EAA8B;EAAA,IAA7BC,WAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAA2B,EAAE;;EACxD,IAAMG,OAAO,GAAGZ,UAAU,CAAC;IAAEQ,WAAW,EAAXA;EAAW,CAAE,CAAC;EAC3C,IAAAK,UAAA,GAAmCZ,SAAS,EAAE;IAA7Ba,aAAa,GAAAD,UAAA,CAAtBE,OAAO;EACf,IAAMC,YAAY,GAAGd,eAAe,EAAE;EAEtC,IAAMe,OAAO,GAAGnB,mBAAmB,CAACU,WAAW,CAAC;EAChD,IAAMO,OAAO,GAAG,CAAAG,EAAA,GAAAV,WAAW,CAACO,OAAO,cAAAG,EAAA,cAAAA,EAAA,GAAIJ,aAAa;EACpD,IAAMK,QAAQ,GAAG,CAAAC,EAAA,GAAAZ,WAAW,CAACW,QAAQ,cAAAC,EAAA,cAAAA,EAAA,GAAIL,OAAO,KAAK,OAAO;EAC5D,IAAMM,gBAAgB,GAAG,OAAON,OAAO,KAAK,QAAQ,GAAGA,OAAO,GAAGJ,SAAS;EAC1E,IAAMW,eAAe,GAAGvB,UAAU,CAChCkB,OAAO,IACLL,OAAO,KAAKD,SAAS,IAAI;IACvBM,OAAO,EAAPA,OAAO;IACPM,IAAI,EAAEnB,gCAAgC;IACtCQ,OAAO,EAAPA,OAAO;IACPO,QAAQ,EAARA,QAAQ;IACRE,gBAAgB,EAAhBA;GACD,CACJ;EACD,IAAMG,UAAU,GAAGzB,UAAU,CAC3BkB,OAAO,IACLL,OAAO,KAAKD,SAAS,IAAI;IACvBM,OAAO,EAAPA,OAAO;IACPM,IAAI,EAAEjB,iCAAiC;IACvCM,OAAO,EAAPA,OAAO;IACPO,QAAQ,EAARA,QAAQ;IACRE,gBAAgB,EAAhBA;GACD,CACJ;EAED,IAAMI,SAAS,GAAGtB,OAAO,CAAC,YAAK;IAC7B,IAAI;MACF,OAAOmB,eAAe,KAAKX,SAAS,GAChC,IAAIe,IAAI,CAAC7B,SAAS,CAAC8B,IAAI,CAACL,eAAe,CAACM,KAAK,CAAC,CAACC,GAAG,CAAC,IAAI,CAAC,CAACC,QAAQ,EAAE,CAAC,GACpEnB,SAAS;KACd,CAAC,OAAOoB,CAAM,EAAE;MACfC,OAAO,CAACC,IAAI,CAAC,sCAAsC,EAAEF,CAAC,CAAC;;EAE3D,CAAC,EAAE,CAACT,eAAe,CAAC,CAAC;EAErB,OAAO;IACLG,SAAS,EAATA,SAAS;IACTD,UAAU,EAAEA,UAAU,KAAKb,SAAS,GAAGd,SAAS,CAAC8B,IAAI,CAACH,UAAU,CAACI,KAAK,CAAC,GAAGjB,SAAS;IACnFuB,WAAW,EAAEtB,OAAO,GAAGI,YAAY,CAACJ,OAAkB,CAAC,GAAGD;GAC3D;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}