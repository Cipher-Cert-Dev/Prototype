{"ast":null,"code":"import _slicedToArray from \"D:/CC/Server/prototype/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { useEffect, useState } from 'react';\nimport LocalStorage from '../helpers/LocalStorage';\nimport { useConfig } from './useConfig';\nfunction getItem(key, storage) {\n  var item = storage.getItem(key);\n  if (item !== null) {\n    try {\n      return JSON.parse(item);\n    } catch (_a) {\n      // ignore error\n    }\n  }\n}\nfunction setItem(key, value, storage) {\n  if (value === undefined) {\n    storage.removeItem(key);\n  } else {\n    var toStore = JSON.stringify(value);\n    try {\n      storage.setItem(key, toStore);\n      return JSON.parse(toStore);\n    } catch (err) {\n      console.error('Error in localStorage', err);\n      storage.removeItem(key);\n    }\n  }\n}\n/**\n * @internal Intended for internal use - use it on your own risk\n */\nexport function useLocalStorage(key) {\n  var _useConfig = useConfig(),\n    _useConfig$localStora = _useConfig.localStorageOverride,\n    localStorageOverride = _useConfig$localStora === void 0 ? typeof window !== 'undefined' ? window.localStorage : new LocalStorage() : _useConfig$localStora;\n  var _useState = useState(function () {\n      return getItem(key, localStorageOverride);\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    value = _useState2[0],\n    setValue = _useState2[1];\n  useEffect(function () {\n    setValue(getItem(key, localStorageOverride));\n  }, [key]);\n  useEffect(function () {\n    setItem(key, value, localStorageOverride);\n  }, [value]);\n  // As value updating relies on useEffect, it takes multiple rerenders to fully update the value.\n  // The third element in the return array allows to get the immediate value stored in the localStorage.\n  return [value, setValue, function () {\n    return getItem(key, localStorageOverride);\n  }];\n}","map":{"version":3,"names":["useEffect","useState","LocalStorage","useConfig","getItem","key","storage","item","JSON","parse","_a","setItem","value","undefined","removeItem","toStore","stringify","err","console","error","useLocalStorage","_useConfig","_useConfig$localStora","localStorageOverride","window","localStorage","_useState","_useState2","_slicedToArray","setValue"],"sources":["D:\\CC\\Server\\prototype\\node_modules\\@usedapp\\core\\src\\hooks\\useLocalStorage.ts"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport LocalStorage from '../helpers/LocalStorage'\nimport { useConfig } from './useConfig'\n\nfunction getItem(key: string, storage: WindowLocalStorage['localStorage']) {\n  const item = storage.getItem(key)\n  if (item !== null) {\n    try {\n      return JSON.parse(item)\n    } catch {\n      // ignore error\n    }\n  }\n}\n\nfunction setItem(key: string, value: any, storage: WindowLocalStorage['localStorage']) {\n  if (value === undefined) {\n    storage.removeItem(key)\n  } else {\n    const toStore = JSON.stringify(value)\n    try {\n      storage.setItem(key, toStore)\n      return JSON.parse(toStore)\n    } catch (err) {\n      console.error('Error in localStorage', err)\n      storage.removeItem(key)\n    }\n  }\n}\n\n/**\n * @internal Intended for internal use - use it on your own risk\n */\nexport function useLocalStorage(key: string) {\n  const {\n    localStorageOverride = typeof window !== 'undefined' ? window.localStorage : new LocalStorage(),\n  } = useConfig()\n\n  const [value, setValue] = useState(() => getItem(key, localStorageOverride))\n\n  useEffect(() => {\n    setValue(getItem(key, localStorageOverride))\n  }, [key])\n\n  useEffect(() => {\n    setItem(key, value, localStorageOverride)\n  }, [value])\n\n  // As value updating relies on useEffect, it takes multiple rerenders to fully update the value.\n  // The third element in the return array allows to get the immediate value stored in the localStorage.\n  return [value, setValue, () => getItem(key, localStorageOverride)] as const\n}\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,OAAOC,YAAY,MAAM,yBAAyB;AAClD,SAASC,SAAS,QAAQ,aAAa;AAEvC,SAASC,OAAOA,CAACC,GAAW,EAAEC,OAA2C;EACvE,IAAMC,IAAI,GAAGD,OAAO,CAACF,OAAO,CAACC,GAAG,CAAC;EACjC,IAAIE,IAAI,KAAK,IAAI,EAAE;IACjB,IAAI;MACF,OAAOC,IAAI,CAACC,KAAK,CAACF,IAAI,CAAC;KACxB,CAAC,OAAAG,EAAA,EAAM;MACN;IAAA;;AAGN;AAEA,SAASC,OAAOA,CAACN,GAAW,EAAEO,KAAU,EAAEN,OAA2C;EACnF,IAAIM,KAAK,KAAKC,SAAS,EAAE;IACvBP,OAAO,CAACQ,UAAU,CAACT,GAAG,CAAC;GACxB,MAAM;IACL,IAAMU,OAAO,GAAGP,IAAI,CAACQ,SAAS,CAACJ,KAAK,CAAC;IACrC,IAAI;MACFN,OAAO,CAACK,OAAO,CAACN,GAAG,EAAEU,OAAO,CAAC;MAC7B,OAAOP,IAAI,CAACC,KAAK,CAACM,OAAO,CAAC;KAC3B,CAAC,OAAOE,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEF,GAAG,CAAC;MAC3CX,OAAO,CAACQ,UAAU,CAACT,GAAG,CAAC;;;AAG7B;AAEA;;;AAGA,OAAM,SAAUe,eAAeA,CAACf,GAAW;EACzC,IAAAgB,UAAA,GAEIlB,SAAS,EAAE;IAAAmB,qBAAA,GAAAD,UAAA,CADbE,oBAAoB;IAApBA,oBAAoB,GAAAD,qBAAA,cAAG,OAAOE,MAAM,KAAK,WAAW,GAAGA,MAAM,CAACC,YAAY,GAAG,IAAIvB,YAAY,EAAE,GAAAoB,qBAAA;EAGjG,IAAAI,SAAA,GAA0BzB,QAAQ,CAAC;MAAA,OAAMG,OAAO,CAACC,GAAG,EAAEkB,oBAAoB,CAAC;IAAA,EAAC;IAAAI,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAArEd,KAAK,GAAAe,UAAA;IAAEE,QAAQ,GAAAF,UAAA;EAEtB3B,SAAS,CAAC,YAAK;IACb6B,QAAQ,CAACzB,OAAO,CAACC,GAAG,EAAEkB,oBAAoB,CAAC,CAAC;EAC9C,CAAC,EAAE,CAAClB,GAAG,CAAC,CAAC;EAETL,SAAS,CAAC,YAAK;IACbW,OAAO,CAACN,GAAG,EAAEO,KAAK,EAAEW,oBAAoB,CAAC;EAC3C,CAAC,EAAE,CAACX,KAAK,CAAC,CAAC;EAEX;EACA;EACA,OAAO,CAACA,KAAK,EAAEiB,QAAQ,EAAE;IAAA,OAAMzB,OAAO,CAACC,GAAG,EAAEkB,oBAAoB,CAAC;EAAA,EAAU;AAC7E"},"metadata":{},"sourceType":"module","externalDependencies":[]}