{"ast":null,"code":"import _slicedToArray from \"D:/CC/prototype/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useEffect, useReducer } from 'react';\nimport { useDebounce } from '../../../hooks';\nimport { useReadonlyNetworks } from '../../network';\nimport { BlockNumbersContext } from './context';\nimport { blockNumberReducer } from '../common/reducer';\nimport { subscribeToNewBlock } from '../common/subscribeToNewBlock';\nimport { useWindow } from '../../window';\nimport { useIsMounted } from '../../../hooks/useIsMounted';\nexport function BlockNumbersProvider(_ref) {\n  var children = _ref.children;\n  var networks = useReadonlyNetworks();\n  var _useReducer = useReducer(blockNumberReducer, {}),\n    _useReducer2 = _slicedToArray(_useReducer, 2),\n    state = _useReducer2[0],\n    dispatch = _useReducer2[1];\n  var isActive = useWindow();\n  var isMounted = useIsMounted();\n  useEffect(function () {\n    var onUnmount = Object.entries(networks).map(function (_ref2) {\n      var _ref3 = _slicedToArray(_ref2, 2),\n        chainId = _ref3[0],\n        provider = _ref3[1];\n      return subscribeToNewBlock(provider, Number(chainId), function () {\n        if (isMounted()) {\n          dispatch.apply(void 0, arguments);\n        }\n      }, isActive);\n    });\n    return function () {\n      return onUnmount.forEach(function (fn) {\n        return fn();\n      });\n    };\n  }, [networks]);\n  var debouncedState = useDebounce(state, 100);\n  return _jsx(BlockNumbersContext.Provider, {\n    value: debouncedState,\n    children: children\n  });\n}","map":{"version":3,"names":["useEffect","useReducer","useDebounce","useReadonlyNetworks","BlockNumbersContext","blockNumberReducer","subscribeToNewBlock","useWindow","useIsMounted","BlockNumbersProvider","_ref","children","networks","_useReducer","_useReducer2","_slicedToArray","state","dispatch","isActive","isMounted","onUnmount","Object","entries","map","_ref2","_ref3","chainId","provider","Number","apply","arguments","forEach","fn","debouncedState","_jsx","Provider","value"],"sources":["D:\\CC\\prototype\\node_modules\\@usedapp\\core\\src\\providers\\blockNumber\\blockNumbers\\provider.tsx"],"sourcesContent":["import { ReactNode, useEffect, useReducer } from 'react'\nimport { useDebounce } from '../../../hooks'\nimport { useReadonlyNetworks } from '../../network'\nimport { BlockNumbersContext } from './context'\nimport { blockNumberReducer } from '../common/reducer'\nimport { subscribeToNewBlock } from '../common/subscribeToNewBlock'\nimport { useWindow } from '../../window'\nimport { useIsMounted } from '../../../hooks/useIsMounted'\n\ninterface Props {\n  children: ReactNode\n}\n\nexport function BlockNumbersProvider({ children }: Props) {\n  const networks = useReadonlyNetworks()\n  const [state, dispatch] = useReducer(blockNumberReducer, {})\n  const isActive = useWindow()\n  const isMounted = useIsMounted()\n\n  useEffect(() => {\n    const onUnmount = Object.entries(networks).map(([chainId, provider]) =>\n      subscribeToNewBlock(\n        provider,\n        Number(chainId),\n        (...args: Parameters<typeof dispatch>) => {\n          if (isMounted()) {\n            dispatch(...args)\n          }\n        },\n        isActive\n      )\n    )\n\n    return () => onUnmount.forEach((fn) => fn())\n  }, [networks])\n\n  const debouncedState = useDebounce(state, 100)\n\n  return <BlockNumbersContext.Provider value={debouncedState} children={children} />\n}\n"],"mappings":";;AAAA,SAAoBA,SAAS,EAAEC,UAAU,QAAQ,OAAO;AACxD,SAASC,WAAW,QAAQ,gBAAgB;AAC5C,SAASC,mBAAmB,QAAQ,eAAe;AACnD,SAASC,mBAAmB,QAAQ,WAAW;AAC/C,SAASC,kBAAkB,QAAQ,mBAAmB;AACtD,SAASC,mBAAmB,QAAQ,+BAA+B;AACnE,SAASC,SAAS,QAAQ,cAAc;AACxC,SAASC,YAAY,QAAQ,6BAA6B;AAM1D,OAAM,SAAUC,oBAAoBA,CAAAC,IAAA,EAAoB;EAAA,IAAjBC,QAAQ,GAAAD,IAAA,CAARC,QAAQ;EAC7C,IAAMC,QAAQ,GAAGT,mBAAmB,EAAE;EACtC,IAAAU,WAAA,GAA0BZ,UAAU,CAACI,kBAAkB,EAAE,EAAE,CAAC;IAAAS,YAAA,GAAAC,cAAA,CAAAF,WAAA;IAArDG,KAAK,GAAAF,YAAA;IAAEG,QAAQ,GAAAH,YAAA;EACtB,IAAMI,QAAQ,GAAGX,SAAS,EAAE;EAC5B,IAAMY,SAAS,GAAGX,YAAY,EAAE;EAEhCR,SAAS,CAAC,YAAK;IACb,IAAMoB,SAAS,GAAGC,MAAM,CAACC,OAAO,CAACV,QAAQ,CAAC,CAACW,GAAG,CAAC,UAAAC,KAAA;MAAA,IAAAC,KAAA,GAAAV,cAAA,CAAAS,KAAA;QAAEE,OAAO,GAAAD,KAAA;QAAEE,QAAQ,GAAAF,KAAA;MAAA,OAChEnB,mBAAmB,CACjBqB,QAAQ,EACRC,MAAM,CAACF,OAAO,CAAC,EACf,YAAyC;QACvC,IAAIP,SAAS,EAAE,EAAE;UACfF,QAAQ,CAAAY,KAAA,SAAAC,SAAQ,CAAC;;MAErB,CAAC,EACDZ,QAAQ,CACT;IAAA,EACF;IAED,OAAO;MAAA,OAAME,SAAS,CAACW,OAAO,CAAC,UAACC,EAAE;QAAA,OAAKA,EAAE,EAAE;MAAA,EAAC;IAAA;EAC9C,CAAC,EAAE,CAACpB,QAAQ,CAAC,CAAC;EAEd,IAAMqB,cAAc,GAAG/B,WAAW,CAACc,KAAK,EAAE,GAAG,CAAC;EAE9C,OAAOkB,IAAA,CAAC9B,mBAAmB,CAAC+B,QAAQ;IAACC,KAAK,EAAEH,cAAc;IAAEtB,QAAQ,EAAEA;EAAQ,EAAI;AACpF"},"metadata":{},"sourceType":"module","externalDependencies":[]}