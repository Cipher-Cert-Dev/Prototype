{"ast":null,"code":"import _createForOfIteratorHelper from \"D:/CC/prototype/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\n/**\n * @internal Intended for internal use - use it on your own risk\n */\nexport function warnOnInvalidFilter(filter) {\n  if (!filter) {\n    return;\n  }\n  var contract = filter.contract,\n    event = filter.event,\n    args = filter.args;\n  console.warn(\"Invalid contract filter: address=\".concat(contract.address, \" event=\").concat(event, \" args=\").concat(args));\n}\n/**\n * @internal Intended for internal use - use it on your own risk\n */\nexport function encodeFilterData(filter, fromBlock, toBlock, blockHash) {\n  if (!filter) {\n    return undefined;\n  }\n  var contract = filter.contract,\n    event = filter.event,\n    args = filter.args;\n  if (!contract.address || !event) {\n    warnOnInvalidFilter(filter);\n    return undefined;\n  }\n  try {\n    var encodedTopics = contract.interface.encodeFilterTopics(event, args);\n    if (blockHash) {\n      return {\n        address: contract.address,\n        topics: encodedTopics,\n        blockHash: blockHash\n      };\n    } else {\n      return {\n        address: contract.address,\n        topics: encodedTopics,\n        fromBlock: fromBlock !== null && fromBlock !== void 0 ? fromBlock : 0,\n        toBlock: toBlock !== null && toBlock !== void 0 ? toBlock : 'latest'\n      };\n    }\n  } catch (e) {\n    if (e instanceof Error) {\n      return e;\n    } else {\n      warnOnInvalidFilter(filter);\n      return undefined;\n    }\n  }\n}\n/**\n * @internal Intended for internal use - use it on your own risk\n */\nexport function decodeLogs(filter, result) {\n  if (!result || !filter) {\n    return undefined;\n  }\n  try {\n    if (result instanceof Error) {\n      return {\n        value: undefined,\n        error: result\n      };\n    }\n    var decodedLogs = [];\n    var _iterator = _createForOfIteratorHelper(result),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var log = _step.value;\n        var data = filter.contract.interface.decodeEventLog(filter.event, log.data, log.topics);\n        decodedLogs.push({\n          data: data,\n          blockNumber: log.blockNumber,\n          blockHash: log.blockHash,\n          transactionIndex: log.transactionIndex,\n          transactionHash: log.transactionHash,\n          removed: log.removed\n        });\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n    return {\n      value: decodedLogs,\n      error: undefined\n    };\n  } catch (error) {\n    return {\n      value: undefined,\n      error: error\n    };\n  }\n}","map":{"version":3,"names":["warnOnInvalidFilter","filter","contract","event","args","console","warn","concat","address","encodeFilterData","fromBlock","toBlock","blockHash","undefined","encodedTopics","interface","encodeFilterTopics","topics","e","Error","decodeLogs","result","value","error","decodedLogs","_iterator","_createForOfIteratorHelper","_step","s","n","done","log","data","decodeEventLog","push","blockNumber","transactionIndex","transactionHash","removed","err","f"],"sources":["D:\\CC\\prototype\\node_modules\\@usedapp\\core\\src\\helpers\\logs.ts"],"sourcesContent":["import { utils } from 'ethers'\nimport type { BlockTag, Filter, FilterByBlockHash, Log } from '@ethersproject/abstract-provider'\nimport { TypedFilter } from '../hooks/useLogs'\nimport { Awaited, ContractEventNames, DetailedEventRecord, EventRecord, Falsy, TypedContract } from '../model/types'\n\n/**\n * @internal Intended for internal use - use it on your own risk\n */\nexport function warnOnInvalidFilter(filter: TypedFilter | Falsy) {\n  if (!filter) {\n    return\n  }\n  const { contract, event, args } = filter\n  console.warn(`Invalid contract filter: address=${contract.address} event=${event} args=${args}`)\n}\n\n/**\n * @internal Intended for internal use - use it on your own risk\n */\nexport function encodeFilterData(\n  filter: TypedFilter | Falsy,\n  fromBlock?: BlockTag,\n  toBlock?: BlockTag,\n  blockHash?: string\n): Filter | FilterByBlockHash | Falsy | Error {\n  if (!filter) {\n    return undefined\n  }\n  const { contract, event, args } = filter\n  if (!contract.address || !event) {\n    warnOnInvalidFilter(filter)\n    return undefined\n  }\n  try {\n    const encodedTopics = contract.interface.encodeFilterTopics((event as unknown) as utils.EventFragment, args)\n\n    if (blockHash) {\n      return {\n        address: contract.address,\n        topics: encodedTopics,\n        blockHash: blockHash,\n      } as FilterByBlockHash\n    } else {\n      return {\n        address: contract.address,\n        topics: encodedTopics,\n        fromBlock: fromBlock ?? 0,\n        toBlock: toBlock ?? 'latest',\n      } as Filter\n    }\n  } catch (e) {\n    if (e instanceof Error) {\n      return e as Error\n    } else {\n      warnOnInvalidFilter(filter)\n      return undefined\n    }\n  }\n}\n\n/**\n * Result of a {@link useLogs} query.\n *\n * It is `undefined` when the query didn't return yet or one of the following objects:\n *\n * - `{ value: DetailedEventRecord[], error: undefined }`, if the query succeeded,\n * - `{ value: undefined, error: Error }`, if the query failed.\n *\n * Type `DetailedEventRecord` represents a single event (log) on a typed contract:\n *\n * ```typescript\n * type DetailedEventRecord<T extends TypedContract, EN extends ContractEventNames<T>> = {\n *   data: EventRecord<T, EN>\n *   blockNumber: number\n *   blockHash: string\n *   transactionIndex: number\n *   transactionHash: string\n *   removed: boolean\n * }\n * ```\n *\n * Additional resources related to events can be found [here](https://docs.soliditylang.org/en/latest/abi-spec.html#events).\n *\n * @public\n */\nexport type LogsResult<T extends TypedContract, EN extends ContractEventNames<T>> =\n  | { value: Awaited<DetailedEventRecord<T, EN>>[]; error: undefined }\n  | { value: undefined; error: Error }\n  | undefined\n\n/**\n * @internal Intended for internal use - use it on your own risk\n */\nexport function decodeLogs<T extends TypedContract, EN extends ContractEventNames<T>>(\n  filter: TypedFilter | Falsy,\n  result: Log[] | Falsy | Error\n): LogsResult<T, EN> {\n  if (!result || !filter) {\n    return undefined\n  }\n  try {\n    if (result instanceof Error) {\n      return {\n        value: undefined,\n        error: result,\n      }\n    }\n\n    const decodedLogs: Awaited<DetailedEventRecord<T, EN>>[] = []\n\n    for (const log of result) {\n      const data = filter.contract.interface.decodeEventLog(filter.event, log.data, log.topics) as EventRecord<T, EN>\n\n      decodedLogs.push({\n        data,\n        blockNumber: log.blockNumber,\n        blockHash: log.blockHash,\n        transactionIndex: log.transactionIndex,\n        transactionHash: log.transactionHash,\n        removed: log.removed,\n      })\n    }\n\n    return {\n      value: decodedLogs,\n      error: undefined,\n    }\n  } catch (error) {\n    return {\n      value: undefined,\n      error: error as Error,\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}